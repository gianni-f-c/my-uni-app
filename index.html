<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Simulatore Esame Farmacologia</title>
    <style>
        :root { --primary: #007aff; --success: #34c759; --error: #ff3b30; --bg: #f2f2f7; }
        body { font-family: -apple-system, system-ui; background-color: var(--bg); display: flex; justify-content: center; padding: 20px; margin: 0; }
        #app { width: 100%; max-width: 500px; background: white; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .question { font-size: 1.3rem; font-weight: 700; margin-bottom: 20px; color: #1c1c1e; }
        .options-container { display: flex; flex-direction: column; gap: 12px; }
        .option { padding: 15px; border: 2px solid #e5e5ea; border-radius: 12px; cursor: pointer; transition: all 0.2s; font-size: 1rem; text-align: left; background: white; }
        .option:active { transform: scale(0.98); }
        .correct { background-color: var(--success) !important; border-color: var(--success); color: white; }
        .wrong { background-color: var(--error) !important; border-color: var(--error); color: white; }
        #feedback { margin-top: 20px; font-weight: 600; min-height: 24px; text-align: center; }
        .btn-next { margin-top: 20px; width: 100%; padding: 15px; border: none; border-radius: 12px; background: var(--primary); color: white; font-size: 1rem; font-weight: 600; cursor: pointer; display: none; }
        #score-board { margin-bottom: 10px; font-size: 0.9rem; color: #8e8e93; text-align: right; }
    </style>
</head>
<body>

<div id="app">
    <div id="score-board">Punteggio: <span id="points">0</span></div>
    <div id="question" class="question">Caricamento...</div>
    <div id="options" class="options-container"></div>
    <div id="feedback"></div>
    <button id="next-btn" class="btn-next" onclick="loadNewQuestion()">Prossima Domanda</button>
</div>

<script>
// La sezione DATA Ã¨ ora pronta per essere riempita
const questions = [
    {q: "Esempio: Meccanismo Statine?", a: "Inibizione HMG-CoA reduttasi"},
    {q: "Esempio: Antidoto Oppioidi?", a: "Naloxone"},
    {q: "Esempio: Antidoto Benzodiazepine?", a: "Flumazenil"},
    {q: "Esempio: Meccanismo Aspirina?", a: "Inibizione irreversibile COX"}
];

let score = 0;
let currentCorrectAnswer = "";

function loadNewQuestion() {
    // Reset interfaccia
    document.getElementById('feedback').innerText = "";
    document.getElementById('next-btn').style.display = "none";
    const optionsDiv = document.getElementById('options');
    optionsDiv.innerHTML = "";

    // Scegli domanda casuale
    const qObj = questions[Math.floor(Math.random() * questions.length)];
    document.getElementById('question').innerText = qObj.q;
    currentCorrectAnswer = qObj.a;

    // Crea lista di risposte (1 corretta + 3 casuali dal database)
    let answers = [qObj.a];
    while(answers.length < 4) {
        let randomA = questions[Math.floor(Math.random() * questions.length)].a;
        if(!answers.includes(randomA)) answers.push(randomA);
    }

    // Mischia le risposte
    answers.sort(() => Math.random() - 0.5);

    // Genera bottoni
    answers.forEach(text => {
        const btn = document.createElement('button');
        btn.className = 'option';
        btn.innerText = text;
        btn.onclick = () => checkAnswer(btn, text);
        optionsDiv.appendChild(btn);
    });
}

function checkAnswer(selectedBtn, text) {
    const allOptions = document.querySelectorAll('.option');
    allOptions.forEach(btn => btn.disabled = true); // Disabilita altri click

    if(text === currentCorrectAnswer) {
        selectedBtn.classList.add('correct');
        document.getElementById('feedback').innerText = "Corretto! ðŸŽ‰";
        document.getElementById('feedback').style.color = "#34c759";
        score++;
    } else {
        selectedBtn.classList.add('wrong');
        document.getElementById('feedback').innerText = "Sbagliato. La risposta corretta era: " + currentCorrectAnswer;
        document.getElementById('feedback').style.color = "#ff3b30";
        // Evidenzia quella corretta
        allOptions.forEach(btn => {
            if(btn.innerText === currentCorrectAnswer) btn.classList.add('correct');
        });
    }

    document.getElementById('points').innerText = score;
    document.getElementById('next-btn').style.display = "block";
}

// Avvio
window.onload = loadNewQuestion;
</script>

</body>
</html>
